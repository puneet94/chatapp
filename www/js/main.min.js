!function(e){"use strict";var t=e.module("petal",["ui.router","ionic","satellizer","ngFileUpload","btford.socket-io","ngCordova","petal.home","petal.post","petal.chat","petal.user","petal.people"]);t.config(["$urlRouterProvider","$stateProvider","$ionicConfigProvider",function(e,t,o){o.tabs.position("bottom"),e.otherwise("/home/post/all")}]),t.run(["$rootScope","$state","$ionicPlatform",function(e,t,o){o.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}])}(window.angular),function(e){"use strict";function t(e){e.state("home.chat",{url:"/chat",abstract:!0,views:{"chat-tab":{templateUrl:"app/chat/views/chatParent.html",controller:"ChatParentController",controllerAs:"ppc"}}}).state("home.chat.all",{url:"/all",views:{"chat-tab":{templateUrl:"app/chat/views/allChat.html",controller:"AllChatController",controllerAs:"apc"}}}).state("home.chat.revealed",{url:"/revealed",views:{"chat-tab":{templateUrl:"app/chat/views/revealedChat.html",controller:"RevealedChatController",controllerAs:"rpc"}}})}e.module("petal.chat",[]).config(["$stateProvider",t])}(window.angular),function(e){"use strict";function t(e,t){var l="https://petalchat-imanjithreddy.c9users.io/authenticate";t.facebook({clientId:"1134208830041632",url:l+"/auth/facebook",redirectUri:"http://localhost:8100"}),t.google({clientId:"742676837265-33jntkd60p87gkrh48nqe6cdd8ntsfl5.apps.googleusercontent.com",url:l+"/auth/google",redirectUri:"http://localhost:8100"}),e.state("authenticate",{url:"/authenticate",controller:"AuthenticationController",controllerAs:"ac",templateUrl:"app/home/views/authenticationPage.html",resolve:{redirectIfUserAuthenticated:["$q","$auth","$state","$timeout",r]}}).state("home",{url:"/home",abstract:!0,templateUrl:"app/home/views/tabs.html",controller:"HomeController",controllerAs:"hc",resolve:{redirectIfUserNotAuthenticated:["$q","$auth","$state","$timeout",o]}})}function o(e,t,o,r){var l=e.defer();return t.isAuthenticated()?l.resolve():(console.log("not audsnf"),r(function(){o.go("authenticate")})),l.promise}function r(e,t){var o=e.defer();return t.isAuthenticated()?o.reject():(console.log("not audsnf"),o.resolve()),o.promise}e.module("petal.home",[]).config(["$stateProvider","$authProvider",t])}(window.angular),function(e){"use strict";function t(e){e.state("home.people",{url:"/people",abstract:!0,views:{"people-tab":{templateUrl:"app/people/views/peopleParent.html",controller:"PeopleParentController",controllerAs:"ppc"}}}).state("home.people.all",{url:"/all",views:{"people-tab":{templateUrl:"app/people/views/allPeople.html",controller:"AllPeopleController",controllerAs:"apc"}}}).state("home.people.revealed",{url:"/revealed",views:{"people-tab":{templateUrl:"app/people/views/revealedPeople.html",controller:"RevealedPeopleController",controllerAs:"rpc"}}}).state("home.people.received",{url:"/received",views:{"people-tab":{templateUrl:"app/people/views/receivedPeople.html",controller:"ReceivedPeopleController",controllerAs:"rpc"}}}).state("home.people.nearby",{url:"/nearby",views:{"people-tab":{templateUrl:"app/people/views/nearbyPeople.html",controller:"NearbyPeopleController",controllerAs:"npc"}}})}e.module("petal.people",[]).config(["$stateProvider",t])}(window.angular),function(e){"use strict";function t(e){e.state("home.post",{url:"/post",abstract:!0,views:{"post-tab":{templateUrl:"app/post/views/postParent.html",controller:"PostParentController",controllerAs:"ppc"}}}).state("home.post.all",{url:"/all",views:{"post-tab":{templateUrl:"app/post/views/allPost.html",controller:"AllPostController",controllerAs:"apc"}}}).state("home.post.latest",{url:"/latest",views:{"post-tab":{templateUrl:"app/post/views/latestPost.html",controller:"LatestPostController",controllerAs:"lpc"}}}).state("home.post.popular",{url:"/popular",views:{"post-tab":{templateUrl:"app/post/views/popularPost.html",controller:"PopularPostController",controllerAs:"ppc"}}}).state("home.post.nearby",{url:"/nearby",views:{"post-tab":{templateUrl:"app/post/views/nearbyPost.html",controller:"NearbyPostController",controllerAs:"npc"}}}).state("home.postSubmit",{url:"/submit",views:{"postSubmit-tab":{templateUrl:"app/post/views/createPost.html",controller:"CreatePostController",controllerAs:"cpc"}}})}e.module("petal.post",[]).config(["$stateProvider",t])}(window.angular),function(e){"use strict";e.module("petal.user",[]).config(["$stateProvider",function(e){e.state("home.user",{url:"/user",views:{"user-tab":{templateUrl:"app/user/views/userParentPage.html",controller:"UserParentController",controllerAs:"upc"}}}).state("home.user.userPage",{url:"/userPage/:userId",views:{"user-tab":{templateUrl:"app/user/views/userProfilePage.html",controller:"UserPageController",controllerAs:"upc"}}}).state("home.user.userMePage",{url:"/userMePage",views:{"user-tab":{templateUrl:"app/user/views/userMePage.html",controller:"UserMePageController",controllerAs:"umpc"}}})}])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.chat").controller("AllChatController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.chat").controller("ChatParentController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.chat").controller("RevealedChatController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t,o,r){function l(e){t.authenticate(e).then(function(t){console.log("from here"),console.log(t),r.setUser(t.data.user),alert("login with "+e+" successfull"),o.go("home.post.all")}).catch(function(e){console.log("error"),console.log(e)})}function s(){t.logout(),r.removeUser(),o.go("authenticate")}var n=this;console.log("authenticate"),n.isAuth=t.isAuthenticated(),console.log(n.isAuth),n.authLogout=s,n.socialAuthenticate=l,console.log(o)}e.module("petal.home").controller("AuthenticationController",["$scope","$auth","$state","userData",t])}(window.angular),function(e){"use strict";function t(e,t){function o(){t.go("home.chat.all")}var r=this;r.badgeValue="",r.chatClicked=o}e.module("petal.home").controller("HomeController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e){this.baseURL="https://petalchat-imanjithreddy.c9users.io/"}e.module("petal.home").service("homeService",["$http",t])}(window.angular),function(e){"use strict";function t(e,t,o){}e.module("petal.home").service("userAuthService",["$http","$auth","baseUrlService","$mdDialog","userData","$window",t])}(window.angular),function(e){"use strict";function t(e,t,o,r,l){var s=e.localStorage,n={},a={setUser:function(e){if(e)s.setItem("user",JSON.stringify(e));else{var t=o.getPayload().sub;t&&r.get(l.baseURL+"user/get/"+t).then(function(e){a.isUserExists()&&s.removeItem("user"),s.setItem("user",JSON.stringify(e.data.user))},function(e){console.log(e)})}},getUser:function(){return JSON.parse(s.getItem("user"))},removeUser:function(){n=null,s.removeItem("user")},isUserExists:function(){return!!a.getUser()}};return a}e.module("petal.home").factory("userData",["$window","$state","$auth","$http","homeService",t])}(window.angular),function(e){"use strict";function t(t,o,r){function l(){a.params.page=1,a.peopleList=[],n()}function s(){a.params.page+=1,n()}function n(){r.getAllUsers(a.params).then(function(t){e.forEach(t.data.docs,function(e){a.peopleList.push(e)})})}var a=this;a.getAllPeople=n,a.pullRefreshPeople=l,a.loadMorePeople=s,a.peopleList=[],a.params={limit:25,page:1},function(){n()}()}e.module("petal.people").controller("AllPeopleController",["$scope","$state","peopleService",t])}(window.angular),function(e){"use strict";function t(e,t,o){function r(){o.submitPost(l.post).then(function(e){console.log(e)}).catch(function(e){console.log("post error"),console.log(e)})}var l=this;l.submitPost=r,l.post={},e.$watch(function(){return l.post.content},function(e,t){e&&e.length>300&&(l.post.content=t)})}e.module("petal.post").controller("CreatePostController",["$scope","$state","postService",t])}(window.angular),function(e){"use strict";function t(t,o,r){function l(){a.params.page=1,a.peopleList=[],n()}function s(){a.params.page+=1,n()}function n(){r.getNearbyUsers(a.params).then(function(t){console.log(t),e.forEach(t.data.docs,function(e){a.peopleList.push(e)})}).catch(function(e){console.log("nearby error"),console.log(e)})}var a=this;a.getNearbyPeople=n,a.pullRefreshPeople=l,a.loadMorePeople=s,a.peopleList=[],a.params={limit:25,page:1,distance:1e3},function(){n()}()}e.module("petal.people").controller("NearbyPeopleController",["$scope","$state","peopleService",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.people").controller("PeopleParentController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.people").controller("ReceivedPeopleController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.people").controller("RequestedPeopleController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.people").controller("RevealedPeopleController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t,o,r){function l(o){return o.all=!0,e.get(t.baseURL+"user/getUsers",{params:o})}function s(o){return o.revealed=!0,e.get(t.baseURL+"user/getUsers",{params:o})}function n(o){return o.received=!0,e.get(t.baseURL+"user/getUsers",{params:o})}function a(o){return o.requested=!0,e.get(t.baseURL+"user/getUsers",{params:o})}function i(l){l.nearby=!0;var s=r.defer();return o.getUserLocation().then(function(o){l.latitude=o.latitude,l.longitude=o.longitude,e.get(t.baseURL+"user/getUsers",{params:l}).then(function(e){s.resolve(e)}).catch(function(e){s.reject(e)})}).catch(function(e){s.reject(e)}),s.promise}this.getAllUsers=l,this.getRevealedUsers=s,this.getNearbyUsers=i,this.getRequestedUsers=a,this.getReceivedUsers=n,this.getNearbyUsers=i}e.module("petal.people").service("peopleService",["$http","homeService","userLocationService","$q",t])}(window.angular),function(e){"use strict";function t(t,o,r){function l(){a.params.page=1,a.postsList=[],n()}function s(){a.params.page+=1,n()}function n(){r.getAllPosts(a.params).then(function(t){console.log(t),e.forEach(t.data.docs,function(e){a.postsList.push(e)})})}var a=this;a.getAllPosts=n,a.pullRefreshPosts=l,a.loadMorePosts=s,a.postsList=[],a.params={limit:25,page:1},function(){n()}()}e.module("petal.post").controller("AllPostController",["$scope","$state","postService",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.post").controller("LatestPostController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.post").controller("NearbyPostController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.post").controller("PopularPostController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.post").controller("PostParentController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t,o,r){function l(o){return e.get(t.baseURL+"post/getPosts",{params:o})}function s(o){return o.nearby=!0,e.get(t.baseURL+"post/getPosts",{params:o})}function n(o){return o.sort="time",e.get(t.baseURL+"post/getPosts",{params:o})}function a(o){return o.sort="upvotesLength",e.get(t.baseURL+"post/getPosts",{params:o})}function i(l){var s=r.defer();return o.getUserLocation().then(function(o){l.latitude=o.latitude,l.longitude=o.longitude,e.post(t.baseURL+"post/create",{post:l}).then(function(e){s.resolve(e)}).catch(function(e){s.reject(e)})}).catch(function(e){s.reject(e)}),s.promise}function c(o){return e.delete(t.baseURL+"post/delete/"+o)}function u(o){return e.get(t.baseURL+"post/get/"+o)}this.getAllPosts=l,this.getNearbyPosts=s,this.getLatestPosts=n,this.getPopularPosts=a,this.submitPost=i,this.deletePost=c,this.getPost=u}e.module("petal.post").service("postService",["$http","homeService","userLocationService","$q",t])}(window.angular),function(e){"use strict";function t(e,t){function o(){var o={timeout:1e4,enableHighAccuracy:!1};return e.getCurrentPosition(o).then(function(e){var o={latitude:e.coords.latitude,longitude:e.coords.longitude};return t.updateUser(o),o})}this.getUserLocation=o}e.module("petal.user").service("userLocationService",["$cordovaGeolocation","userService",t])}(window.angular),function(e){"use strict";function t(e,t){function o(o){return e.get(t.baseURL+"user/get/"+o)}function r(o){return e.post(t.baseURL+"user/update/",{user:o})}this.updateUser=r,this.getUser=o}e.module("petal.user").service("userService",["$http","homeService",t])}(window.angular);