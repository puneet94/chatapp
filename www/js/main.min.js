!function(e){"use strict";var t=e.module("petal",["ui.router","ionic","satellizer","ngFileUpload","btford.socket-io","ngCordova","petal.home","petal.post","petal.chat","petal.user","petal.people"]);t.config(["$urlRouterProvider","$stateProvider","$ionicConfigProvider",function(e,t,o){o.tabs.position("bottom"),e.otherwise("/home/post/all")}]),t.run(["$rootScope","$state","$ionicPlatform",function(e,t,o){o.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}])}(window.angular),function(e){"use strict";function t(e){e.state("home.chat",{url:"/chat",abstract:!0,views:{"chat-tab":{templateUrl:"app/chat/views/chatParent.html",controller:"ChatParentController",controllerAs:"ppc"}}}).state("home.chat.all",{url:"/all",views:{"chat-tab":{templateUrl:"app/chat/views/allChat.html",controller:"AllChatController",controllerAs:"apc"}}}).state("home.chat.revealed",{url:"/revealed",views:{"chat-tab":{templateUrl:"app/chat/views/revealedChat.html",controller:"RevealedChatController",controllerAs:"rpc"}}}).state("chatBox",{url:"/chatBox/:user",templateUrl:"app/chat/views/chatBox.html",controller:"ChatBoxController",controllerAs:"cbc"})}e.module("petal.chat",[]).config(["$stateProvider",t])}(window.angular),function(e){"use strict";function t(e,t){var s="https://petalchat-imanjithreddy.c9users.io/authenticate";t.facebook({clientId:"1134208830041632",url:s+"/auth/facebook",redirectUri:"http://localhost:8100"}),t.google({clientId:"742676837265-33jntkd60p87gkrh48nqe6cdd8ntsfl5.apps.googleusercontent.com",url:s+"/auth/google",redirectUri:"http://localhost:8100"}),e.state("authenticate",{url:"/authenticate",controller:"AuthenticationController",controllerAs:"ac",templateUrl:"app/home/views/authenticationPage.html",resolve:{redirectIfUserAuthenticated:["$q","$auth","$state","$timeout",r]}}).state("home",{url:"/home",abstract:!0,templateUrl:"app/home/views/tabs.html",controller:"HomeController",controllerAs:"hc",resolve:{redirectIfUserNotAuthenticated:["$q","$auth","$state","$timeout",o]}})}function o(e,t,o,r){var s=e.defer();return t.isAuthenticated()?s.resolve():(console.log("not audsnf"),r(function(){o.go("authenticate")})),s.promise}function r(e,t){var o=e.defer();return t.isAuthenticated()?o.reject():(console.log("not audsnf"),o.resolve()),o.promise}e.module("petal.home",[]).config(["$stateProvider","$authProvider",t])}(window.angular),function(e){"use strict";function t(e){e.state("home.people",{url:"/people",abstract:!0,views:{"people-tab":{templateUrl:"app/people/views/peopleParent.html",controller:"PeopleParentController",controllerAs:"ppc"}}}).state("home.people.all",{url:"/all",views:{"people-tab":{templateUrl:"app/people/views/allPeople.html",controller:"AllPeopleController",controllerAs:"apc"}}}).state("home.people.revealed",{url:"/revealed",views:{"people-tab":{templateUrl:"app/people/views/revealedPeople.html",controller:"RevealedPeopleController",controllerAs:"rpc"}}}).state("home.people.received",{url:"/received",views:{"people-tab":{templateUrl:"app/people/views/receivedPeople.html",controller:"ReceivedPeopleController",controllerAs:"rpc"}}}).state("home.people.nearby",{url:"/nearby",views:{"people-tab":{templateUrl:"app/people/views/nearbyPeople.html",controller:"NearbyPeopleController",controllerAs:"npc"}}})}e.module("petal.people",[]).config(["$stateProvider",t])}(window.angular),function(e){"use strict";function t(e){e.state("home.post",{url:"/post",abstract:!0,views:{"post-tab":{templateUrl:"app/post/views/postParent.html",controller:"PostParentController",controllerAs:"ppc"}}}).state("home.post.all",{url:"/all",views:{"post-tab":{templateUrl:"app/post/views/allPost.html",controller:"AllPostController",controllerAs:"apc"}}}).state("home.post.latest",{url:"/latest",views:{"post-tab":{templateUrl:"app/post/views/latestPost.html",controller:"LatestPostController",controllerAs:"lpc"}}}).state("home.post.popular",{url:"/popular",views:{"post-tab":{templateUrl:"app/post/views/popularPost.html",controller:"PopularPostController",controllerAs:"ppc"}}}).state("home.post.nearby",{url:"/nearby",views:{"post-tab":{templateUrl:"app/post/views/nearbyPost.html",controller:"NearbyPostController",controllerAs:"npc"}}}).state("home.postSubmit",{url:"/submit",views:{"postSubmit-tab":{templateUrl:"app/post/views/createPost.html",controller:"CreatePostController",controllerAs:"cpc"}}}).state("singlePost",{url:"/post/:id",templateUrl:"app/post/views/singlePost.html",controller:"SinglePostController",controllerAs:"spc"})}e.module("petal.post",[]).config(["$stateProvider",t])}(window.angular),function(e){"use strict";e.module("petal.user",[]).config(["$stateProvider",function(e){e.state("home.user",{url:"/user",views:{"user-tab":{templateUrl:"app/user/views/userParentPage.html",controller:"UserParentController",controllerAs:"upc"}}}).state("home.user.userPage",{url:"/userPage/:userId",views:{"user-tab":{templateUrl:"app/user/views/userProfilePage.html",controller:"UserPageController",controllerAs:"upc"}}}).state("home.user.userMePage",{url:"/userMePage",views:{"user-tab":{templateUrl:"app/user/views/userMePage.html",controller:"UserMePageController",controllerAs:"umpc"}}})}])}(window.angular),function(e){"use strict";function t(t,o,r){function s(){l.params.page=1,l.chatRoomsList=[],a()}function n(){l.params.page+=1,a()}function a(){r.getAllChatRooms(l.params).then(function(t){e.forEach(t.data.docs,function(e){l.chatRoomsList.push(e)})})}var l=this;l.params={page:1,limit:25},l.chatRoomsList=[],l.getAllChatRooms=a,l.loadMoreChats=n,l.pullRefreshChats=s,function(){a()}()}e.module("petal.chat").controller("AllChatController",["$scope","$state","chatService",t])}(window.angular),function(e){"use strict";function t(t,o,r,s,n,a){function l(){n.getChatMessages(i.chatRoomId).then(function(t){e.forEach(t.data[0].chats,function(e){i.chatList.push(e)})},function(e){console.log(e)})}function c(){o.emit("addToRoom",{roomId:i.chatRoomId}),o.on("messageSaved",function(e){i.chatList.push(e)})}var i=this;i.currentUser=s.getUser()._id,i.receiverUser="",i.chatList=[],i.chatRoomId="",i.messageLoading=!1,function(){n.getChatRoom(r.user).then(function(e){console.log("the response the room"),console.log(e),i.chatRoomId=e.data._id,i.currentUser=e.data.creator1,i.receiverUserId=e.data.creator2,console.log("the reciver id"+i.receiverUserId),console.log("the reciver id2"+i.currentUser),c(),l()},function(e){console.log(e)})}(),i.clickSubmit=function(){i.messageLoading=!0;var e={message:i.myMsg,user:i.currentUser,roomId:i.chatRoomId};n.sendChatMessage(e).then(function(e){i.myMsg=" ",i.messageLoading=!1,console.log(e)},function(e){console.log(e)})}}e.module("app.chat").controller("ChatBoxController",["$scope","Socket","$stateParams","userData","chatService","userService",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.chat").controller("ChatParentController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(t,o,r){function s(){l.params.page=1,l.chatRoomsList=[],a()}function n(){l.params.page+=1,a()}function a(){r.getRevealedChatRooms(l.params).then(function(t){e.forEach(t.data.docs,function(e){l.chatRoomsList.push(e)})})}var l=this;l.params={page:1,limit:25},l.chatRoomsList=[],l.getRevealedChatRooms=a,l.loadMoreChats=n,l.pullRefreshChats=s,function(){a()}()}e.module("petal.chat").controller("RevealedChatController",["$scope","$state","chatService",t])}(window.angular),function(e){"use strict";function t(e,t,o){function r(t){return e.post(o.baseURL+"chat/create/"+t.roomId,t)}function s(t){return e.get(o.baseURL+"chat/getChats/"+t)}function n(t){return e.get(o.baseURL+"chatRoom/get/"+t)}function a(t){return t.revealed=!1,e.get(o.baseURL+"chatRoom/all/",{params:t})}function l(t){return t.revealed=!0,e.get(o.baseURL+"chatRoom/all/",{params:t})}var c=this;c.sendChatMessage=r,c.getChatMessages=s,c.getChatRoom=n,c.getAllChatRooms=a,c.getRevealedChatRooms=l}e.module("petal.chat").service("chatService",["$http","$stateParams","homeService",t])}(window.angular),function(e){"use strict";function t(e,t,o,r){function s(e){t.authenticate(e).then(function(t){console.log("from here"),console.log(t),r.setUser(t.data.user),alert("login with "+e+" successfull"),o.go("home.post.all")}).catch(function(e){console.log("error"),console.log(e)})}function n(){t.logout(),r.removeUser(),o.go("authenticate")}var a=this;console.log("authenticate"),a.isAuth=t.isAuthenticated(),console.log(a.isAuth),a.authLogout=n,a.socialAuthenticate=s,console.log(o)}e.module("petal.home").controller("AuthenticationController",["$scope","$auth","$state","userData",t])}(window.angular),function(e){"use strict";function t(e,t){function o(){t.go("home.chat.all")}var r=this;r.badgeValue="",r.chatClicked=o}e.module("petal.home").controller("HomeController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e){this.baseURL="https://petalchat-imanjithreddy.c9users.io/"}e.module("petal.home").service("homeService",["$http",t])}(window.angular),function(e){"use strict";function t(e,t,o){}e.module("petal.home").service("userAuthService",["$http","$auth","baseUrlService","$mdDialog","userData","$window",t])}(window.angular),function(e){"use strict";function t(e,t,o,r,s){var n=e.localStorage,a={},l={setUser:function(e){if(e)n.setItem("user",JSON.stringify(e));else{var t=o.getPayload().sub;t&&r.get(s.baseURL+"user/get/"+t).then(function(e){l.isUserExists()&&n.removeItem("user"),n.setItem("user",JSON.stringify(e.data.user))},function(e){console.log(e)})}},getUser:function(){return JSON.parse(n.getItem("user"))},removeUser:function(){a=null,n.removeItem("user")},isUserExists:function(){return!!l.getUser()}};return l}e.module("petal.home").factory("userData",["$window","$state","$auth","$http","homeService",t])}(window.angular),function(e){"use strict";function t(t,o,r){function s(){l.params.page=1,l.peopleList=[],a()}function n(){l.params.page+=1,a()}function a(){r.getAllUsers(l.params).then(function(t){e.forEach(t.data.docs,function(e){l.peopleList.push(e)})})}var l=this;l.getAllPeople=a,l.pullRefreshPeople=s,l.loadMorePeople=n,l.peopleList=[],l.params={limit:25,page:1},function(){a()}()}e.module("petal.people").controller("AllPeopleController",["$scope","$state","peopleService",t])}(window.angular),function(e){"use strict";function t(e,t,o){function r(){o.submitPost(s.post).then(function(e){console.log(e)}).catch(function(e){console.log("post error"),console.log(e)})}var s=this;s.submitPost=r,s.post={},e.$watch(function(){return s.post.content},function(e,t){e&&e.length>300&&(s.post.content=t)})}e.module("petal.post").controller("CreatePostController",["$scope","$state","postService",t])}(window.angular),function(e){"use strict";function t(t,o,r){function s(){l.params.page=1,l.peopleList=[],a()}function n(){l.params.page+=1,a()}function a(){r.getNearbyUsers(l.params).then(function(t){console.log(t),e.forEach(t.data.docs,function(e){l.peopleList.push(e)})}).catch(function(e){console.log("nearby error"),console.log(e)})}var l=this;l.getNearbyPeople=a,l.pullRefreshPeople=s,l.loadMorePeople=n,l.peopleList=[],l.params={limit:25,page:1,distance:1e3},function(){a()}()}e.module("petal.people").controller("NearbyPeopleController",["$scope","$state","peopleService",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.people").controller("PeopleParentController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.people").controller("ReceivedPeopleController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.people").controller("RequestedPeopleController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.people").controller("RevealedPeopleController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t,o,r){function s(o){return o.all=!0,e.get(t.baseURL+"user/getUsers",{params:o})}function n(o){return o.revealed=!0,e.get(t.baseURL+"user/getUsers",{params:o})}function a(o){return o.received=!0,e.get(t.baseURL+"user/getUsers",{params:o})}function l(o){return o.requested=!0,e.get(t.baseURL+"user/getUsers",{params:o})}function c(s){s.nearby=!0;var n=r.defer();return o.getUserLocation().then(function(o){s.latitude=o.latitude,s.longitude=o.longitude,e.get(t.baseURL+"user/getUsers",{params:s}).then(function(e){n.resolve(e)}).catch(function(e){n.reject(e)})}).catch(function(e){n.reject(e)}),n.promise}this.getAllUsers=s,this.getRevealedUsers=n,this.getNearbyUsers=c,this.getRequestedUsers=l,this.getReceivedUsers=a,this.getNearbyUsers=c}e.module("petal.people").service("peopleService",["$http","homeService","userLocationService","$q",t])}(window.angular),function(e){"use strict";function t(t,o,r){function s(){l.params.page=1,l.postsList=[],a()}function n(){l.params.page+=1,a()}function a(){r.getAllPosts(l.params).then(function(t){console.log(t),e.forEach(t.data.docs,function(e){l.postsList.push(e)})})}var l=this;l.getAllPosts=a,l.pullRefreshPosts=s,l.loadMorePosts=n,l.postsList=[],l.params={limit:25,page:1},function(){a()}()}e.module("petal.post").controller("AllPostController",["$scope","$state","postService",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.post").controller("LatestPostController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.post").controller("NearbyPostController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.post").controller("PopularPostController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t){}e.module("petal.post").controller("PostParentController",["$scope","$state",t])}(window.angular),function(e){"use strict";function t(e,t,o,r,s){function n(){o.getPost(r.id).then(function(e){console.log("singlepost"),console.log(e)})}var a=this;a.getSinglePost=n,a.back=function(){s.goBack()},function(){n()}()}e.module("petal.post").controller("SinglePostController",["$scope","$state","postService","$stateParams","$ionicHistory",t])}(window.angular),function(e){"use strict";function t(e,t,o,r){function s(o){return e.get(t.baseURL+"post/getPosts",{params:o})}function n(o){return o.nearby=!0,e.get(t.baseURL+"post/getPosts",{params:o})}function a(o){return o.sort="time",e.get(t.baseURL+"post/getPosts",{params:o})}function l(o){return o.sort="upvotesLength",e.get(t.baseURL+"post/getPosts",{params:o})}function c(s){var n=r.defer();return o.getUserLocation().then(function(o){s.latitude=o.latitude,s.longitude=o.longitude,e.post(t.baseURL+"post/create",{post:s}).then(function(e){n.resolve(e)}).catch(function(e){n.reject(e)})}).catch(function(e){n.reject(e)}),n.promise}function i(o){return e.delete(t.baseURL+"post/delete/"+o)}function u(o){return e.get(t.baseURL+"post/get/"+o)}this.getAllPosts=s,this.getNearbyPosts=n,this.getLatestPosts=a,this.getPopularPosts=l,this.submitPost=c,this.deletePost=i,this.getPost=u}e.module("petal.post").service("postService",["$http","homeService","userLocationService","$q",t])}(window.angular),function(e){"use strict";function t(e,t){function o(){var o={timeout:1e4,enableHighAccuracy:!1};return e.getCurrentPosition(o).then(function(e){var o={latitude:e.coords.latitude,longitude:e.coords.longitude};return t.updateUser(o),o})}this.getUserLocation=o}e.module("petal.user").service("userLocationService",["$cordovaGeolocation","userService",t])}(window.angular),function(e){"use strict";function t(e,t){function o(o){return e.get(t.baseURL+"user/get/"+o)}function r(o){return e.post(t.baseURL+"user/update/",{user:o})}this.updateUser=r,this.getUser=o}e.module("petal.user").service("userService",["$http","homeService",t])}(window.angular);